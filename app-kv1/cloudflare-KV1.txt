Cloudflare KV ã‚’å…±é€šã®ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã—ã¦ã€è¤‡æ•°ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒåˆ©ç”¨ã§ãã‚‹ **APIï¼ˆKey-Value Storage APIï¼‰** ã‚’ä½œã‚‹å ´åˆã€ä»¥ä¸‹ã®è¦ä»¶ã‚’æº€ãŸã™ã¨ä¾¿åˆ©ã§ã™ã€‚

### **è¦ä»¶**
1. **çµ±ä¸€ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**ï¼ˆã‚¢ãƒ—ãƒªã”ã¨ã«ç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã§ã‚‚çµ±ä¸€çš„ã«æ‰±ãˆã‚‹ï¼‰
2. **ã‚¢ãƒ—ãƒªã”ã¨ã®ãƒ‡ãƒ¼ã‚¿åˆ†é›¢**ï¼ˆåå‰ç©ºé–“ãƒ»ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ç®¡ç†ï¼‰
3. **JSON å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãƒ»å–å¾—**
4. **åœ§ç¸®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆã‚µã‚¤ã‚ºå‰Šæ¸›ï¼‰**
5. **èªè¨¼ï¼ˆAPIã‚­ãƒ¼ or JWTï¼‰**

---

## **1. Cloudflare Workers ã§ API ã‚’æ§‹ç¯‰**
Cloudflare Workers ã‚’ä½¿ã£ã¦ã€Cloudflare KV (ex. store0) ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ API ã‚’ä½œæˆã—ã¾ã™ã€‚

### **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ**
| ãƒ¡ã‚½ãƒƒãƒ‰ | ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | å†…å®¹ |
|----------|--------------|------|
| `POST`   | `/kv/set`    | ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ |
| `GET`    | `/kv/get/app0/key0`    | ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾— |
| `DELETE` | `/kv/delete` | ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ |
| `PUT`    | `/kv/set`    | ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–° |
| `GET`    | `/kv/list/app0`   | ã‚­ãƒ¼ã®ãƒªã‚¹ãƒˆã‚’å–å¾— |

---


index.js

export default {
	async fetch(req, env) {
		const url = new URL(req.url);
		const { method } = req;

		// CORS Middleware
		const withCors = (res) => {
			res.headers.set('Access-Control-Allow-Origin', '*');
			res.headers.set('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
			res.headers.set('Access-Control-Allow-Headers', 'Content-Type');
			return res;
		};

		// Preflight req Handling (OPTIONS method)
		if (method === 'OPTIONS') {
			return withCors(new Response(null, { status: 204 }));
		}

		// Handle POST /kv/set
		if (url.pathname === '/kv/set' && method === 'POST') {
			try {
				const { app, key, value } = await req.json();
				if (!app || !key || !value) return withCors(new Response('Missing app, key, or value', { status: 400 }));

				await env.store0.put(`${app}:${key}`, JSON.stringify(value)); // Namespaced Key
				return withCors(new Response(JSON.stringify({ success: true }), { status: 200 }));
			} catch (error) {
				return withCors(new Response(error.toString(), { status: 500 }));
			}
		}

		// Handle GET /kv/get/:app/:key
		if (url.pathname.startsWith('/kv/get/') && method === 'GET') {
			const [, , , app, key] = url.pathname.split('/');
			if (!app || !key) return withCors(new Response('Missing app or key', { status: 400 }));

			const value = await env.store0.get(`${app}:${key}`);
			return value ? withCors(new Response(value)) : withCors(new Response('Not Found', { status: 404 }));
		}

		// Handle DELETE /kv/delete/:app/:key
		if (url.pathname.startsWith('/kv/delete/') && method === 'DELETE') {
			const [, , , app, key] = url.pathname.split('/');
			if (!app || !key) return withCors(new Response('Missing app or key', { status: 400 }));

			await env.store0.delete(`${app}:${key}`);
			return withCors(new Response(JSON.stringify({ success: true }), { status: 200 }));
		}

		// Handle GET /kv/list/:app
		if (url.pathname.startsWith('/kv/list/') && method === 'GET') {
			const [, , , app] = url.pathname.split('/');
			if (!app) return withCors(new Response('Missing app', { status: 400 }));

			const list = await env.store0.list({ prefix: `${app}:` });
			const keys = list.keys.map((k) => k.name.replace(`${app}:`, ''));
			return withCors(new Response(JSON.stringify(keys), { status: 200 }));
		}

		// 404 Not Found
		return withCors(new Response('Not Found', { status: 404 }));
	},
};





APIã®å‹•ä½œç¢ºèª

npx wrangler dev

curl -X GET http://localhost:8787/kv/get/app1/key1

curl -X POST http://localhost:8787/kv/set \
  -H "Content-Type: application/json" \
  -d '{"app": "app1", "key": "key1", "value": "Hello from app1-1"}'

curl -X POST http://localhost:8787/kv/set \
  -H "Content-Type: application/json" \
  -d '{"app": "app1", "key": "key2", "value": "Hello from app1-2"}'

curl -X GET http://localhost:8787/kv/get/app1/key1
curl -X GET http://localhost:8787/kv/get/app1/key2

curl -X POST http://localhost:8787/kv/set \
  -H "Content-Type: application/json" \
  -d '{"app": "app2", "key": "key1", "value": "Hello from app2-1"}'

curl -X GET http://localhost:8787/kv/get/app1/key2

curl -X GET http://localhost:8787/kv/list/app1

curl -X PUT http://localhost:8787/kv/set \
  -H "Content-Type: application/json" \
  -d '{"app": "app1", "key": "key1", "value": "Updated message from app1-1"}'

curl -X GET http://localhost:8787/kv/get/app1/key1

curl -X DELETE http://localhost:8787/kv/delete/app1/key2

curl http://localhost:8787/kv/get/app1/key1

curl -X GET http://localhost:8787/kv/list/app1


npx wranger deploy


---


### **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ Cloudflare Workers API ã‚’ä½¿ã†æ–¹æ³•**  
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã® JavaScript ã‹ã‚‰ API ã‚’ä½¿ã£ã¦ Cloudflare KV ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ãƒ»å–å¾—ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚

---

## **ğŸ“Œ 1. API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä»•æ§˜**
ã¾ãšã€Cloudflare Workers API ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¢ºèªã—ã¾ã™ã€‚

| **HTTP ãƒ¡ã‚½ãƒƒãƒ‰** | **ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**       | **èª¬æ˜** |
|-----------------|--------------------|------------|
| `POST`         | `/kv/set`           | ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ãƒ»æ›´æ–° |
| `GET`          | `/kv/get/{app}/{key}` | ãƒ‡ãƒ¼ã‚¿ã®å–å¾— |
| `DELETE`       | `/kv/delete/{app}/{key}` | ãƒ‡ãƒ¼ã‚¿ã®å‰Šé™¤ |
| `GET`          | `/kv/list/{app}`    | ã‚¢ãƒ—ãƒªã”ã¨ã®ã‚­ãƒ¼ä¸€è¦§å–å¾— |

> **API ã®ãƒ™ãƒ¼ã‚¹ URL**
> - **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ:** `http://localhost:8787`
> - **ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œ:** `https://your-cloudflare-worker-url.com`

---

## **ğŸ“Œ 2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã® JavaScript ã‚³ãƒ¼ãƒ‰**
ä»¥ä¸‹ã® JavaScript é–¢æ•°ã‚’ä½¿ã£ã¦ API ã‚’å‘¼ã³å‡ºã›ã¾ã™ã€‚

### **ğŸ”¹ ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜**
```javascript
async function saveData(app, key, value) {
    const response = await fetch("http://localhost:8787/kv/set", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ app, key, value })
    });
    return response.json();
}

// ä¾‹: "app1" ã® "key1" ã‚­ãƒ¼ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
saveData("app1", "key1", "Hello, Cloudflare!").then(console.log);
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```json
{"success": true}
```

---

### **ğŸ”¹ ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—**
```javascript
async function getData(app, key) {
    const response = await fetch(`http://localhost:8787/kv/get/${app}/${key}`);
    if (!response.ok) throw new Error("Data not found");
    return response.text();
}

// ä¾‹: "app1" ã® "key1" ã‚’å–å¾—
getData("app1", "key1").then(console.log).catch(console.error);
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```json
"Hello, Cloudflare!"
```

---

### **ğŸ”¹ ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°**
ãƒ‡ãƒ¼ã‚¿ä¿å­˜ (`/kv/set`) ã¨åŒã˜ API ã‚’ä½¿ã†ã®ã§ã€`saveData()` ã‚’å‘¼ã³å‡ºã›ã° OKã€‚

```javascript
saveData("app1", "key1", "Updated message").then(console.log);
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```json
{"success": true}
```

---

### **ğŸ”¹ ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤**
```javascript
async function deleteData(app, key) {
    const response = await fetch(`http://localhost:8787/kv/delete/${app}/${key}`, {
        method: "DELETE"
    });
    return response.json();
}

// ä¾‹: "app1" ã® "key1" ã‚’å‰Šé™¤
deleteData("app1", "key1").then(console.log);
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```json
{"success": true}
```

---

### **ğŸ”¹ ã‚¢ãƒ—ãƒªã”ã¨ã®ã‚­ãƒ¼ä¸€è¦§ã‚’å–å¾—**
```javascript
async function listKeys(app) {
    const response = await fetch(`http://localhost:8787/kv/list/${app}`);
    return response.json();
}

// ä¾‹: "app1" ã®ã‚­ãƒ¼ä¸€è¦§ã‚’å–å¾—
listKeys("app1").then(console.log);
```

âœ… **æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```json
["message", "anotherKey"]
```

---

## **ğŸ“Œ 3. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¢ãƒ—ãƒªã®çµ„ã¿è¾¼ã¿ä¾‹**
ä¾‹ãˆã°ã€HTML ã®ãƒ•ã‚©ãƒ¼ãƒ ã¨é€£æºã—ã¦ API ã‚’ä½¿ã†ä¾‹:

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloudflare KV API Demo</title>
</head>
<body>
    <h1>Cloudflare KV API Demo</h1>

    <input type="text" id="key" placeholder="Key">
    <input type="text" id="value" placeholder="Value">
    <button onclick="save()">Save</button>
    <button onclick="load()">Load</button>

    <p id="result"></p>

    <script>
        const app = "app1"; // å›ºå®šã®ã‚¢ãƒ—ãƒªå

        async function save() {
            const key = document.getElementById("key").value;
            const value = document.getElementById("value").value;
            const res = await saveData(app, key, value);
            document.getElementById("result").innerText = JSON.stringify(res);
        }

        async function load() {
            const key = document.getElementById("key").value;
            try {
                const value = await getData(app, key);
                document.getElementById("result").innerText = value;
            } catch (e) {
                document.getElementById("result").innerText = "Not Found";
            }
        }
    </script>
</body>
</html>
```


| **æ“ä½œ** | **é–¢æ•°** | **API** |
|---------|---------|--------|
| ãƒ‡ãƒ¼ã‚¿ä¿å­˜ | `saveData(app, key, value)` | `POST /kv/set` |
| ãƒ‡ãƒ¼ã‚¿å–å¾— | `getData(app, key)` | `GET /kv/get/{app}/{key}` |
| ãƒ‡ãƒ¼ã‚¿æ›´æ–° | `saveData(app, key, value)` | `POST /kv/set` |
| ãƒ‡ãƒ¼ã‚¿å‰Šé™¤ | `deleteData(app, key)` | `DELETE /kv/delete/{app}/{key}` |
| ã‚­ãƒ¼ä¸€è¦§å–å¾— | `listKeys(app)` | `GET /kv/list/{app}` |

---






`pako` ã¯ zlib ã®åœ§ç¸®ãƒ»è§£å‡ã‚’è¡Œã† JavaScript ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚Cloudflare Workers ã§ã‚‚ `gzip`/`ungzip` ã‚’æ‰±ã†ã®ã«ä¾¿åˆ©ã§ã™ã€‚  

## **`pako` ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
ã‚‚ã—ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã§ä½¿ã†å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚

```sh
npm install pako
```

## **gzip åœ§ç¸®ã—ã¦ Cloudflare KV ã«ä¿å­˜**
Cloudflare KV ã¯ **æœ€å¤§25MBã®ãƒ‡ãƒ¼ã‚¿** ã‚’ä¿å­˜ã§ãã‚‹ãŸã‚ã€å¤§ããª JSON ãƒ‡ãƒ¼ã‚¿ãªã©ã‚’åœ§ç¸®ã™ã‚‹ã¨ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨è»¢é€é‡ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚

```javascript
import { gzip } from 'pako';

const data = { type: "log", messages: ["ãƒ­ã‚°1", "ãƒ­ã‚°2", "ãƒ­ã‚°3"] };
const compressed = gzip(JSON.stringify(data));

// Cloudflare KV ã«ä¿å­˜
await env.KV_NAMESPACE.put("logs:001", compressed, { expirationTtl: 86400 });
```

`expirationTtl: 86400` ã¯ **24æ™‚é–“å¾Œã«ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•å‰Šé™¤** ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ï¼ˆä¸è¦ãªã‚‰çœç•¥ï¼‰ã€‚

---

## **Cloudflare KV ã‹ã‚‰å–ã‚Šå‡ºã—ã¦è§£å‡**
ä¿å­˜ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šå‡ºã—ã€è§£å‡ã—ã¦å…ƒã® JSON ã«æˆ»ã—ã¾ã™ã€‚

```javascript
import { ungzip } from 'pako';

const compressedData = await env.KV_NAMESPACE.get("logs:001", { type: "arrayBuffer" });

if (compressedData) {
  const decompressed = JSON.parse(new TextDecoder().decode(ungzip(new Uint8Array(compressedData))));
  console.log(decompressed);  // { type: "log", messages: ["ãƒ­ã‚°1", "ãƒ­ã‚°2", "ãƒ­ã‚°3"] }
}
```

---

## **ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„ã«æ³¨æ„**
Cloudflare KV ã® `put` ã¯ **æ–‡å­—åˆ—ï¼ˆstringï¼‰** ã§ä¿å­˜ã™ã‚‹ã®ãŒåŸºæœ¬ã§ã™ãŒã€`Uint8Array` ã‚„ `ArrayBuffer` ã‚‚ä¿å­˜å¯èƒ½ã§ã™ã€‚ãã®å ´åˆã€`get` æ™‚ã« `{ type: "arrayBuffer" }` ã‚’æŒ‡å®šã—ãªã„ã¨ã€ãƒ‡ãƒ¼ã‚¿ãŒæ–‡å­—åˆ—ã¨ã—ã¦ç ´æã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### **ãƒã‚¤ãƒŠãƒªã‚’ Base64 ã«å¤‰æ›ã—ã¦ä¿å­˜ã™ã‚‹æ–¹æ³•**
ã‚‚ã— `arrayBuffer` ã‚’ä½¿ã„ãŸããªã„å ´åˆã¯ã€Base64 å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚

```javascript
import { gzip } from 'pako';

// Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
function encodeBase64(bytes) {
  return btoa(String.fromCharCode(...bytes));
}

// Base64ãƒ‡ã‚³ãƒ¼ãƒ‰
function decodeBase64(str) {
  return new Uint8Array([...atob(str)].map(c => c.charCodeAt(0)));
}

// ãƒ‡ãƒ¼ã‚¿ã‚’åœ§ç¸®ã—ã¦ Base64 ã«å¤‰æ›
const compressedBase64 = encodeBase64(gzip(JSON.stringify(data)));

// KV ã«ä¿å­˜
await env.KV_NAMESPACE.put("logs:001", compressedBase64);
```

### **å–å¾—æ™‚ã«è§£å‡**
```javascript
import { ungzip } from 'pako';

const compressedBase64 = await env.KV_NAMESPACE.get("logs:001");

if (compressedBase64) {
  const decompressed = JSON.parse(new TextDecoder().decode(ungzip(decodeBase64(compressedBase64))));
  console.log(decompressed);
}
```

---

## **ã©ã®æ–¹æ³•ã‚’é¸ã¶ã¹ãã‹ï¼Ÿ**
| æ–¹æ³• | é•·æ‰€ | çŸ­æ‰€ |
|------|------|------|
| **é€šå¸¸ã® JSON æ–‡å­—åˆ—** | ãã®ã¾ã¾ä¿å­˜ã§ãã‚‹ | å¤§ããªãƒ‡ãƒ¼ã‚¿ã¯ã‚µã‚¤ã‚ºå¢—åŠ  |
| **gzip åœ§ç¸® + ArrayBuffer** | ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã‚’å¤§å¹…å‰Šæ¸› | `arrayBuffer` æŒ‡å®šãŒå¿…è¦ |
| **gzip åœ§ç¸® + Base64** | `arrayBuffer` ã‚’ä½¿ã‚ãªãã¦æ¸ˆã‚€ | Base64å¤‰æ›ã§å°‘ã—ã‚µã‚¤ã‚ºå¢—åŠ  |

åœ§ç¸®ã—ã¦ä¿å­˜ã™ã‚‹ãªã‚‰ã€åŸºæœ¬ã¯ `gzip + ArrayBuffer` ã§ OK ã§ã™ã€‚Base64 ã¯ JSON ã®ã¿ã‚’æ‰±ã†å ´åˆã«ä¾¿åˆ©ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã¯å°‘ã—å¢—ãˆã¾ã™ã€‚

Cloudflare KV ã«å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãªã‚‰ã€**gzip åœ§ç¸®ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨ã‚³ã‚¹ãƒˆã‚’æ”¹å–„** ã§ãã¾ã™ï¼ ğŸš€





èªè¨¼ã¨èªå¯ã€ãƒãƒ«ã‚¯æ“ä½œã€TTLä»˜ããƒ‡ãƒ¼ã‚¿ä¿å­˜ã€æ¤œç´¢æ©Ÿèƒ½ã€ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®ã‚µãƒãƒ¼ãƒˆã€ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒã‚’åŠ ãˆãŸAPIã®ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

```javascript
export default {
  async fetch(req, env) {
    const url = new URL(req.url);
    const { method } = req;

    // CORS Middleware
    const withCors = (res) => {
      res.headers.set('Access-Control-Allow-Origin', '*');
      res.headers.set('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
      res.headers.set('Access-Control-Allow-Headers', 'Content-Type');
      return res;
    };

    // èªè¨¼ã¨èªå¯
    const authenticate = (req) => {
      const authHeader = req.headers.get('Authorization');
      if (!authHeader || authHeader !== 'Bearer YOUR_API_KEY') {
        return new Response('Unauthorized', { status: 401 });
      }
      return null; // èªè¨¼ãŒæˆåŠŸã—ãŸå ´åˆã¯nullã‚’è¿”ã™
    };

    // Preflight req Handling (OPTIONS method)
    if (method === 'OPTIONS') {
      return withCors(new Response(null, { status: 204 }));
    }

    // ãƒãƒ«ã‚¯æ“ä½œ (POST /kv/bulk-set)
    if (url.pathname === '/kv/bulk-set' && method === 'POST') {
      const authError = authenticate(req);
      if (authError) return authError;

      try {
        const { items } = await req.json();
        if (!Array.isArray(items)) return withCors(new Response('Items must be an array', { status: 400 }));

        for (const { app, key, value, ttl } of items) {
          if (!app || !key || value === undefined) {
            return withCors(new Response('Missing app, key, or value', { status: 400 }));
          }

          const options = ttl ? { expirationTtl: ttl } : {};
          await env.store0.put(`${app}:${key}`, JSON.stringify(value), options);
        }

        return withCors(new Response(JSON.stringify({ success: true }), { status: 200 }));
      } catch (error) {
        return withCors(new Response(error.toString(), { status: 500 }));
      }
    }

    // TTLä»˜ããƒ‡ãƒ¼ã‚¿ä¿å­˜ (POST /kv/set)
    if (url.pathname === '/kv/set' && method === 'POST') {
      const authError = authenticate(req);
      if (authError) return authError;

      try {
        const { app, key, value, ttl } = await req.json();
        if (!app || !key || value === undefined) {
          return withCors(new Response('Missing app, key, or value', { status: 400 }));
        }

        const options = ttl ? { expirationTtl: ttl } : {};
        await env.store0.put(`${app}:${key}`, JSON.stringify(value), options);

        return withCors(new Response(JSON.stringify({ success: true }), { status: 200 }));
      } catch (error) {
        return withCors(new Response(error.toString(), { status: 500 }));
      }
    }

    // æ¤œç´¢æ©Ÿèƒ½ (GET /kv/list/:app)
    if (url.pathname.startsWith('/kv/list/') && method === 'GET') {
      const authError = authenticate(req);
      if (authError) return authError;

      const [, , , app] = url.pathname.split('/');
      if (!app) return withCors(new Response('Missing app', { status: 400 }));

      try {
        const list = await env.store0.list({ prefix: `${app}:` });
        const keys = list.keys.map((k) => k.name.replace(`${app}:`, ''));
        return withCors(new Response(JSON.stringify(keys), { status: 200 }));
      } catch (error) {
        return withCors(new Response('Error listing data', { status: 500 }));
      }
    }

    // ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®ã‚µãƒãƒ¼ãƒˆ (PUT /kv/update)
    if (url.pathname === '/kv/update' && method === 'PUT') {
      const authError = authenticate(req);
      if (authError) return authError;

      try {
        const { app, key, newValue } = await req.json();
        if (!app || !key || newValue === undefined) {
          return withCors(new Response('Missing app, key, or new value', { status: 400 }));
        }

        const oldValue = await env.store0.get(`${app}:${key}`);
        if (!oldValue) return withCors(new Response('Key not found', { status: 404 }));

        await env.store0.put(`${app}:${key}`, JSON.stringify(newValue));
        return withCors(new Response(JSON.stringify({ success: true }), { status: 200 }));
      } catch (error) {
        return withCors(new Response('Error updating data', { status: 500 }));
      }
    }

    // ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒ (GET /kv/backup, POST /kv/restore)
    if (url.pathname === '/kv/backup' && method === 'GET') {
      const authError = authenticate(req);
      if (authError) return authError;

      try {
        const list = await env.store0.list({});
        const backupData = await Promise.all(
          list.keys.map(async (k) => {
            const value = await env.store0.get(k.name);
            return { key: k.name, value: JSON.parse(value) };
          })
        );
        return withCors(new Response(JSON.stringify(backupData), { status: 200 }));
      } catch (error) {
        return withCors(new Response('Error backing up data', { status: 500 }));
      }
    }

    if (url.pathname === '/kv/restore' && method === 'POST') {
      const authError = authenticate(req);
      if (authError) return authError;

      try {
        const { backupData } = await req.json();
        if (!Array.isArray(backupData)) return withCors(new Response('Backup data must be an array', { status: 400 }));

        for (const { key, value } of backupData) {
          if (!key || value === undefined) {
            return withCors(new Response('Invalid backup data format', { status: 400 }));
          }
          await env.store0.put(key, JSON.stringify(value));
        }

        return withCors(new Response(JSON.stringify({ success: true }), { status: 200 }));
      } catch (error) {
        return withCors(new Response('Error restoring data', { status: 500 }));
      }
    }

    // 404 Not Found
    return withCors(new Response('Not Found', { status: 404 }));
  },
};
```

### æ©Ÿèƒ½ã®è©³ç´°ï¼š
1. **èªè¨¼ã¨èªå¯**:
   - `authenticate`é–¢æ•°ã§ã€`Authorization`ãƒ˜ãƒƒãƒ€ãƒ¼ã«å«ã¾ã‚Œã‚‹APIã‚­ãƒ¼ã‚’ç¢ºèªã—ã¾ã™ã€‚
   - `Bearer YOUR_API_KEY`ãŒæ­£ã—ã„å ´åˆã®ã¿ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã¾ã™ã€‚

`Bearer YOUR_API_KEY` ã¯ã€APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«èªè¨¼æƒ…å ±ã¨ã—ã¦è¿½åŠ ã™ã‚‹æ–‡å­—åˆ—ã§ã™ã€‚ã“ã®å½¢å¼ã¯ã€**Bearerãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼**ã¨å‘¼ã°ã‚Œã€APIã‚¢ã‚¯ã‚»ã‚¹ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã«ã‚ˆãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

å…·ä½“çš„ã«ã¯ã€`YOUR_API_KEY` ã‚’ã‚ãªãŸãŒè¨­å®šã—ãŸAPIã‚­ãƒ¼ã«ç½®ãæ›ãˆã¾ã™ã€‚ã“ã®APIã‚­ãƒ¼ã¯ã€APIã®åˆ©ç”¨ã‚’è¨±å¯ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸã‚‚ã®ã§ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè¨±å¯ã•ã‚ŒãŸã‚‚ã®ã‹ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã«ä½¿ã‚ã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ã€ã‚‚ã—APIã‚­ãƒ¼ãŒ `1234567890abcdef` ã§ã‚ã‚Œã°ã€èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

```bash
Authorization: Bearer 1234567890abcdef
```

ã“ã®`Authorization` ãƒ˜ãƒƒãƒ€ãƒ¼ã¯ã€APIã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ã‚‰ã‚Œã‚‹éš›ã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒèªè¨¼ã•ã‚ŒãŸã‚‚ã®ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚APIã‚­ãƒ¼ãŒç„¡åŠ¹ã€ã¾ãŸã¯æŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã¯ `401 Unauthorized` ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¾ã™ã€‚

`YOUR_API_KEY` ã¨ã„ã†éƒ¨åˆ†ã¯ã€å®Ÿéš›ã«è‡ªåˆ†ãŒè¨­å®šã—ãŸAPIã‚­ãƒ¼ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚
if (!authHeader || authHeader !== 'Bearer 1234567890abcdef')



2. **ãƒãƒ«ã‚¯æ“ä½œ** (`POST /kv/bulk-set`):
   - è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åº¦ã«ä¿å­˜ã—ã¾ã™ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«ã¯`items`ã¨ã„ã†é…åˆ—ã§è¤‡æ•°ã®ã‚­ãƒ¼ã¨å€¤ã‚’æŒ‡å®šã§ãã¾ã™ã€‚
   - å„ã‚¢ã‚¤ãƒ†ãƒ ã«ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§`ttl`ï¼ˆæœ‰åŠ¹æœŸé™ï¼‰ã‚’è¨­å®šã§ãã¾ã™ã€‚

3. **TTLä»˜ããƒ‡ãƒ¼ã‚¿ä¿å­˜** (`POST /kv/set`):
   - é€šå¸¸ã®`set`æ“ä½œã§ã™ãŒã€`ttl`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿ã®æœ‰åŠ¹æœŸé™ã‚’è¨­å®šã§ãã¾ã™ã€‚

4. **æ¤œç´¢æ©Ÿèƒ½** (`GET /kv/list/:app`):
   - æŒ‡å®šã—ãŸã‚¢ãƒ—ãƒªåã§å§‹ã¾ã‚‹ã‚­ãƒ¼ã‚’ãƒªã‚¹ãƒˆåŒ–ã—ã¾ã™ã€‚

5. **ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®ã‚µãƒãƒ¼ãƒˆ** (`PUT /kv/update`):
   - æ—¢å­˜ã®ã‚­ãƒ¼ã®å€¤ã‚’æ›´æ–°ã—ã¾ã™ã€‚æŒ‡å®šã—ãŸã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯404ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã—ã¾ã™ã€‚

6. **ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨å¾©å…ƒ**:
   - `GET /kv/backup`: ç¾åœ¨ã®ã™ã¹ã¦ã®ã‚­ãƒ¼ã¨ãã®å€¤ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚
   - `POST /kv/restore`: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã—ã¾ã™ã€‚



ä»¥ä¸‹ã¯ã€å„æ©Ÿèƒ½ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã® `curl` ã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚`YOUR_API_KEY` ã¯å®Ÿéš›ã«ä½¿ç”¨ã™ã‚‹APIã‚­ãƒ¼ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

---

npx wrangler dev

### 1. **èªè¨¼ã¨èªå¯**

èªè¨¼ã‚’é€šéã™ã‚‹ãŸã‚ã«ã¯ã€`Authorization` ãƒ˜ãƒƒãƒ€ãƒ¼ã« `Bearer YOUR_API_KEY` ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```bash
curl -X GET http://localhost:8787/kv/list/app1 \
-H "Authorization: Bearer YOUR_API_KEY"
```

---

### 2. **ãƒãƒ«ã‚¯æ“ä½œ (POST /kv/bulk-set)**

è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€åº¦ã«ä¿å­˜ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«`curl`ã‚’ä½¿ã„ã¾ã™ã€‚

```bash
curl -X POST http://localhost:8787/kv/bulk-set \
-H "Content-Type: application/json" \
-H "Authorization: Bearer YOUR_API_KEY" \
-d '{
  "items": [
    { "app": "app1", "key": "key11", "value": "value11", "ttl": 3600 },
    { "app": "app2", "key": "key21", "value": "value21" }
  ]
}'
```

---

### 3. **TTLä»˜ããƒ‡ãƒ¼ã‚¿ä¿å­˜ (POST /kv/set)**

`ttl` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¾ã™ã€‚

```bash
curl -X POST http://localhost:8787/kv/set \
-H "Content-Type: application/json" \
-H "Authorization: Bearer YOUR_API_KEY" \
-d '{
  "app": "app1",
  "key": "key13",
  "value": "value13",
  "ttl": 3600
}'
```

---

### 4. **æ¤œç´¢æ©Ÿèƒ½ (GET /kv/list/:app)**

æŒ‡å®šã•ã‚ŒãŸã‚¢ãƒ—ãƒªã«é–¢é€£ã™ã‚‹ã‚­ãƒ¼ã®ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚

```bash
curl -X GET http://localhost:8787/kv/list/app1 \
-H "Authorization: Bearer YOUR_API_KEY"
```

---

### 5. **ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®ã‚µãƒãƒ¼ãƒˆ (PUT /kv/update)**

æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã¾ã™ã€‚æŒ‡å®šã—ãŸã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯404ã‚¨ãƒ©ãƒ¼ãŒè¿”ã•ã‚Œã¾ã™ã€‚

```bash
curl -X PUT http://localhost:8787/kv/update \
-H "Content-Type: application/json" \
-H "Authorization: Bearer YOUR_API_KEY" \
-d '{
  "app": "app1",
  "key": "key11",
  "newValue": "updated_value"
}'
```

---

### 6. **ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— (GET /kv/backup)**

ç¾åœ¨ã®ã™ã¹ã¦ã®ã‚­ãƒ¼ã¨ãã®å€¤ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

```bash
curl -X GET "http://localhost:8787/kv/backup" \
-H "Authorization: Bearer YOUR_API_KEY"
```

---

### 7. **ãƒ‡ãƒ¼ã‚¿ã®å¾©å…ƒ (POST /kv/restore)**

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã—ã¾ã™ã€‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã¯JSONå½¢å¼ã§æ¸¡ã—ã¾ã™ã€‚

```bash
curl -X POST "http://localhost:8787/kv/restore" \
-H "Content-Type: application/json" \
-H "Authorization: Bearer YOUR_API_KEY" \
-d '{
  "backupData": [
    { "key": "someapp:key1", "value": "restored_value1" },
    { "key": "someapp:key2", "value": "restored_value2" }
  ]
}'
```

---

- **`-X`**: ä½¿ç”¨ã™ã‚‹HTTPãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆGETã€POSTã€PUTãªã©ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
- **`-H`**: HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒ‡å®šã—ã¾ã™ã€‚`Authorization` ãƒ˜ãƒƒãƒ€ãƒ¼ã§èªè¨¼æƒ…å ±ã‚’æ¸¡ã—ã¾ã™ã€‚
- **`-d`**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã¨ã—ã¦é€ä¿¡ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¾ã™ï¼ˆPOSTã€PUTãƒªã‚¯ã‚¨ã‚¹ãƒˆç”¨ï¼‰ã€‚


wrangler deploy




### 1. **HTMLæ§‹é€ **

ã¾ãšã€APIã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªHTMLæ§‹é€ ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã‚„å–å¾—ã€ã‚­ãƒ¼ã®ä¸€è¦§è¡¨ç¤ºã‚’è¡Œã†ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API Frontend</title>
</head>
<body>
  <h1>API Interaction</h1>

  <h2>Create or Update Data</h2>
  <form id="setDataForm">
    <input type="text" id="setApp" placeholder="App Name" required>
    <input type="text" id="setKey" placeholder="Key" required>
    <textarea id="setValue" placeholder="Value" required></textarea>
    <input type="number" id="setTTL" placeholder="TTL (seconds)">
    <button type="submit">Save Data</button>
  </form>

  <h2>Retrieve Data</h2>
  <form id="getDataForm">
    <input type="text" id="getApp" placeholder="App Name" required>
    <input type="text" id="getKey" placeholder="Key" required>
    <button type="submit">Get Data</button>
  </form>

  <h2>List Keys</h2>
  <form id="listDataForm">
    <input type="text" id="listApp" placeholder="App Name" required>
    <button type="submit">List Keys</button>
  </form>

  <h2>Output</h2>
  <pre id="output"></pre>

  <script src="app.js"></script>
</body>
</html>
```

### 2. **JavaScriptã‚³ãƒ¼ãƒ‰ (app.js)**

æ¬¡ã«ã€APIã¨é€šä¿¡ã‚’è¡Œã†ãŸã‚ã®JavaScriptã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡æ™‚ã«`fetch`ã‚’ä½¿ã£ã¦APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç”»é¢ã«è¡¨ç¤ºã—ã¾ã™ã€‚

```javascript
const apiUrl = 'https://your-api-url'; // Replace with your actual API URL
const apiKey = 'YOUR_API_KEY'; // Replace with your actual API key

// Function to display the API response
const showOutput = (response) => {
  document.getElementById('output').textContent = JSON.stringify(response, null, 2);
};

// Handle the "Set Data" form submission
document.getElementById('setDataForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const app = document.getElementById('setApp').value;
  const key = document.getElementById('setKey').value;
  const value = document.getElementById('setValue').value;
  const ttl = document.getElementById('setTTL').value || null;

  try {
    const response = await fetch(`${apiUrl}/kv/set`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${apiKey}`
      },
      body: JSON.stringify({ app, key, value, ttl })
    });
    const data = await response.json();
    showOutput(data);
  } catch (error) {
    showOutput({ error: error.message });
  }
});

// Handle the "Get Data" form submission
document.getElementById('getDataForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const app = document.getElementById('getApp').value;
  const key = document.getElementById('getKey').value;

  try {
    const response = await fetch(`${apiUrl}/kv/get/${app}/${key}`, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${apiKey}`
      }
    });

    const data = await response.text();
    showOutput(data);
  } catch (error) {
    showOutput({ error: error.message });
  }
});

// Handle the "List Keys" form submission
document.getElementById('listDataForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const app = document.getElementById('listApp').value;

  try {
    const response = await fetch(`${apiUrl}/kv/list/${app}`, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${apiKey}`
      }
    });
    const data = await response.json();
    showOutput(data);
  } catch (error) {
    showOutput({ error: error.message });
  }
});
```

### 3. **å„éƒ¨åˆ†ã®èª¬æ˜**

- **HTMLéƒ¨åˆ†**:
  - `setDataForm`: ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒ ã€‚ã‚¢ãƒ—ãƒªåã€ã‚­ãƒ¼ã€å€¤ã€ãŠã‚ˆã³TTLã‚’å…¥åŠ›ã—ã¾ã™ã€‚
  - `getDataForm`: ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒ ã€‚ã‚¢ãƒ—ãƒªåã¨ã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
  - `listDataForm`: ã‚¢ãƒ—ãƒªã«é–¢é€£ã™ã‚‹ã‚­ãƒ¼ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒ ã€‚
  - çµæœã¯`<pre>`ã‚¿ã‚°ã«è¡¨ç¤ºã•ã‚Œã€JSONå½¢å¼ã§å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

- **JavaScriptéƒ¨åˆ†**:
  - **setData**: ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ã•ã‚Œã‚‹ã¨ã€`/kv/set`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«`POST`ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚
  - **getData**: ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ã•ã‚Œã‚‹ã¨ã€`/kv/get/:app/:key`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«`GET`ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚
  - **listKeys**: ã‚¢ãƒ—ãƒªåã«é–¢é€£ã™ã‚‹ã‚­ãƒ¼ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ã€`/kv/list/:app`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«`GET`ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚

- **APIã¨ã®é€šä¿¡**:
  - `YOUR_API_KEY`ã«ã¯ã€å®Ÿéš›ã®APIã‚­ãƒ¼ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
  - `https://your-api-url`ã«ã¯ã€APIã®URLã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚

### 4. **å®Ÿè¡Œæ–¹æ³•**

1. `index.html`ã¨`app.js`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã¾ã™ã€‚
2. `index.html`ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã¾ã™ã€‚
3. å„ãƒ•ã‚©ãƒ¼ãƒ ã‚’ä½¿ã£ã¦ã€APIã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚

### ä¾‹: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹

1. **ãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ»æ›´æ–°**: 
   - å…¥åŠ›: `app = "someapp"`, `key = "user1"`, `value = "John Doe"`, `ttl = 3600`
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: `{ "success": true }`

2. **ãƒ‡ãƒ¼ã‚¿å–å¾—**:
   - å…¥åŠ›: `app = "someapp"`, `key = "user1"`
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: `"John Doe"`

3. **ã‚­ãƒ¼ä¸€è¦§è¡¨ç¤º**:
   - å…¥åŠ›: `app = "someapp"`
   - ãƒ¬ã‚¹ãƒãƒ³ã‚¹: `["user1", "user2"]`

